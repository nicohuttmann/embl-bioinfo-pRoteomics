<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 9 Reporting results | Data Analysis in R</title>
<meta name="author" content="Nico Hüttmann">
<meta name="description" content="Now we have the results of our analysis and the plot in R. But not on the desk of our PI yet. Let’s change this. We would need to export our plot and the results table.  9.1 Export graphics The...">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content="Chapter 9 Reporting results | Data Analysis in R">
<meta property="og:type" content="book">
<meta property="og:description" content="Now we have the results of our analysis and the plot in R. But not on the desk of our PI yet. Let’s change this. We would need to export our plot and the results table.  9.1 Export graphics The...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 9 Reporting results | Data Analysis in R">
<meta name="twitter:description" content="Now we have the results of our analysis and the plot in R. But not on the desk of our PI yet. Let’s change this. We would need to export our plot and the results table.  9.1 Export graphics The...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Data Analysis in R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">R Basics</li>
<li><a class="" href="r-and-rstudio.html"><span class="header-section-number">1</span> R and RStudio</a></li>
<li><a class="" href="how-does-r-work.html"><span class="header-section-number">2</span> How does R work?</a></li>
<li><a class="" href="r-packages.html"><span class="header-section-number">3</span> R packages</a></li>
<li><a class="" href="the-tidyverse.html"><span class="header-section-number">4</span> The tidyverse</a></li>
<li><a class="" href="coding-style.html"><span class="header-section-number">5</span> Coding style</a></li>
<li class="book-part">Group Work Project</li>
<li><a class="" href="our-project.html"><span class="header-section-number">6</span> Our project</a></li>
<li><a class="" href="working-with-data.html"><span class="header-section-number">7</span> Working with data</a></li>
<li><a class="" href="limma-analysis.html"><span class="header-section-number">8</span> Limma analysis</a></li>
<li><a class="active" href="reporting-results.html"><span class="header-section-number">9</span> Reporting results</a></li>
<li><a class="" href="more-data-exploration.html"><span class="header-section-number">10</span> More data exploration</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="version-control-with-github.html"><span class="header-section-number">A</span> Version control with GitHub</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/nicohuttmann/embl-bioinfo-pRoteomics">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="reporting-results" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Reporting results<a class="anchor" aria-label="anchor" href="#reporting-results"><i class="fas fa-link"></i></a>
</h1>
<p>Now we have the results of our analysis and the plot in R. But not on the desk of our PI yet. Let’s change this. We would need to export our plot and the results table.</p>
<div id="export-graphics" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Export graphics<a class="anchor" aria-label="anchor" href="#export-graphics"><i class="fas fa-link"></i></a>
</h2>
<p>The simple and quick way to export your plots is by clicking ‘Export’ on top of you plots. You can then choose to export and image like a .png or a .pdf file. .pdf files can be very useful, as they can be imported into Adobe Illustrator and font etc. could be further adjusted. Also possible with <code>ggplot2</code> for most parts, but still convenient.</p>
<p>Other ways include functions like the <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggplot2::ggsave()</a></code> function, base R solutions like <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> or knitting an R Markdown file. I very much like the last approach for the day to day work and would only put more effort into exporting precise dimension etc. with the <code><a href="https://rdrr.io/r/grDevices/pdf.html">pdf()</a></code> or <code><a href="https://rdrr.io/r/grDevices/png.html">tiff()</a></code> function. For now, and the presentation, you can export them manually as described at the beginning.</p>
</div>
<div id="exporting-data" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Exporting data<a class="anchor" aria-label="anchor" href="#exporting-data"><i class="fas fa-link"></i></a>
</h2>
<p>To export the data, we want to make sure to include only important information and annotation of the results and the peptides. Then, we need to decide on the output format. Usually we would want either a .csv or a .xlsx file.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;For you and you PI, respectively.&lt;/p&gt;"><sup>42</sup></a></p>
<p>Let’s check the results table <code>View(limma_list[["results"]])</code>and decide what to keep and what we may need to add.</p>
<p>My suggestions are to specify <code>id</code> to Modified.Sequence or even better Modified.Peptide, <code>estimate</code> to log2.FC, keep <code>p.value</code>, <code>p.adjust</code> and <code>regulation</code>, and drop <code>term</code>, <code>statistic</code>, <code>lod</code>.</p>
<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#button47" aria-expanded="false" aria-controls="button47">
Code
</button>
<div id="button47" class="collapse">
<p><br></p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">limma_list</span><span class="op">[[</span><span class="st">"export"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">limma_list</span><span class="op">[[</span><span class="st">"results"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>Modified.Peptide <span class="op">=</span> <span class="va">id</span>, </span>
<span>         log2.FC <span class="op">=</span> <span class="va">estimate</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">statistic</span>, <span class="va">lod</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<p><br>
Further, we could add some information we had previously in <code>data_peptides_v</code> like the <code>Protein.Group</code> and the <code>Genes</code>
column. We could do this by joining the <code>tibble</code>s together or in a simpler way.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">limma_list</span><span class="op">[[</span><span class="st">"export"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">limma_list</span><span class="op">[[</span><span class="st">"export"</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Protein.Group <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">data_peptides_v</span>, <span class="va">Protein.Group</span>, <span class="va">Modified.Sequence</span><span class="op">)</span><span class="op">[</span><span class="va">Modified.Peptide</span><span class="op">]</span>, </span>
<span>         Genes <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">data_peptides_v</span>, <span class="va">Genes</span>, <span class="va">Modified.Sequence</span><span class="op">)</span><span class="op">[</span><span class="va">Modified.Peptide</span><span class="op">]</span>, </span>
<span>         .after <span class="op">=</span> <span class="st">"Modified.Peptide"</span><span class="op">)</span></span></code></pre></div>
<p>Now we also have some additional information regarding our peptides which we would need to interpret the results. This data frame can now be exported.</p>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To a .csv</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">limma_list</span><span class="op">[[</span><span class="st">"export"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"Output/limma_results.csv"</span><span class="op">)</span></span>
<span><span class="co"># To an .xlsx</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/openxlsx/man/write.xlsx.html">write.xlsx</a></span><span class="op">(</span><span class="va">limma_list</span><span class="op">[[</span><span class="st">"export"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"Output/limma_results.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>A table and a plot, what more could they ask from us. Oh, there are probably a lot of things which people may want to see things like a principal component analysis (PCA) plot to see how well the samples cluster by group, or an overview of the peptide intensities or CV values, to get insight into the quantitative values. We can explore some of those in the following chapter.</p>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="limma-analysis.html"><span class="header-section-number">8</span> Limma analysis</a></div>
<div class="next"><a href="more-data-exploration.html"><span class="header-section-number">10</span> More data exploration</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#reporting-results"><span class="header-section-number">9</span> Reporting results</a></li>
<li><a class="nav-link" href="#export-graphics"><span class="header-section-number">9.1</span> Export graphics</a></li>
<li><a class="nav-link" href="#exporting-data"><span class="header-section-number">9.2</span> Exporting data</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/nicohuttmann/embl-bioinfo-pRoteomics/blob/master/02-group_project.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/nicohuttmann/embl-bioinfo-pRoteomics/edit/master/02-group_project.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Data Analysis in R</strong>" was written by Nico Hüttmann. It was last built on 2025-02-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
